{"version":3,"file":"server.js","sourceRoot":"","sources":["server.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;YAMI,GAAG,GAAG,MAAM,CAAC,OAAO,GAAG,QAAQ,EAAE,CAAC;YAEtC,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,4BAAsB,EAAE,CAAC,CAAC,CAAC;YAE7D,GAAG,CAAC,KAAK,GAAG;gBACV,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC;oBAChB,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;oBACpB,IAAI,OAAO,GAAG,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;oBAChD,OAAO,CAAC,GAAG,CAAC,+BAA+B,EAAE,OAAO,CAAC,CAAC;oBACtD,EAAE,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC,CAAC,CAAC;wBAC3C,IAAI,YAAY,GAAG,GAAG,CAAC,GAAG,CAAC,6BAA6B,CAAC,CAAC,SAAS,CAAC;oBAEtE,CAAC;gBACH,CAAC,CAAC,CAAC;YACL,CAAC,CAAC;YAIF,IAAI,CAAC,GAAG,EAAE,SAAS,EAAE,UAAC,GAAG;gBACvB,EAAE,CAAC,CAAC,GAAG,CAAC;oBAAC,MAAM,GAAG,CAAC;gBAGnB,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,KAAK,MAAM,CAAC;oBAC1B,GAAG,CAAC,KAAK,EAAE,CAAC;YAChB,CAAC,CAAC,CAAC;YAOH,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,YAAY,GAAG;gBACjC,OAAO,EAAE,UAAS,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,cAAc;oBAC7C,GAAG,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oBAG1B,cAAc,CAAC,GAAG,CAAC,CAAC;gBACtB,CAAC;gBACD,iBAAiB,EAAE,IAAI;aACxB,CAAC;YAEF,GAAG,CAAC,UAAU,GAAG,UAAS,GAAG;gBAC3B,GAAG,CAAC,OAAO,GAAG,kBAAkB,GAAG,GAAG,CAAC,OAAO,CAAC;gBAC/C,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC;gBAGjB,OAAO,GAAG,CAAC,UAAU,CAAC;gBAEtB,MAAM,CAAC,GAAG,CAAC;YACb,CAAC,CAAC;QAEF,CAAC","sourcesContent":["import * as loopback from 'loopback';\nimport * as bodyParser from 'body-parser'\nimport * as boot from 'loopback-boot';\nimport * as path from 'path';\nimport {verifyRequestSignature} from './middleware/bot';\n\nlet app = module.exports = loopback();\n\napp.use(bodyParser.json({ verify: verifyRequestSignature }));\n\napp.start = () => {\n  return app.listen(() => {\n    app.emit('started');\n    let baseUrl = app.get('url').replace(/\\/$/, '');\n    console.log('Web server listening at: %s\\n', baseUrl);\n    if (app.get('loopback-component-explorer')) {\n      let explorerPath = app.get('loopback-component-explorer').mountPath;\n      //console.log('Browse your REST API at %s%s', baseUrl, explorerPath);\n    }\n  });\n};\n\n// Bootstrap the application, configure models, datasources and middleware.\n// Sub-apps like REST API are mounted via boot scripts.\nboot(app, __dirname, (err) => {\n  if (err) throw err;\n\n  // start the server if `$ node server.js`\n  if (require.main === module)\n    app.start();\n});\n\n/*app.get('/', (req,res) => {\n  console.log(__dirname);\n  res.sendFile(path.join(__dirname+'/client/index.html'));\n})*/\n\napp.get('remoting').errorHandler = {\n  handler: function(err, req, res, defaultHandler) {\n    err = app.buildError(err);\n\n    // send the error back to the original handler\n    defaultHandler(err);\n  },\n  disableStackTrace: true\n};\n\napp.buildError = function(err) {\n  err.message = 'Custom message: ' + err.message;\n  err.status = 408; // override the status\n\n  // remove the statusCode property\n  delete err.statusCode;\n\n  return err;\n};\n\n"]}
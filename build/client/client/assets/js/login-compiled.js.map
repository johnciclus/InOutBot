{"version":3,"sources":["login.js"],"names":[],"mappings":"aAAA,GAAM,SAAU,QAAQ,iBAAR,CAAhB,CACA,GAAM,aAAc,QAAQ,cAAR,CAApB,CAEA,QAAS,qBAAT,CAA8B,QAA9B,CAAwC,CACpC,QAAQ,GAAR,CAAY,sBAAZ,EACA,QAAQ,GAAR,CAAY,QAAZ,EACA;AACA;AACA;AACA;AACA,GAAI,SAAS,MAAT,GAAoB,WAAxB,CAAqC,CACjC;AAEA,GAAI,KAAM,SAAS,YAAT,CAAsB,MAAhC,CACA,GAAI,aAAc,SAAS,YAAT,CAAsB,WAAxC,CAEA,oBAAoB,SAApB,CAA8B,QAAS,QAAT,CAAiB,IAAjB,CAAuB,CACjD,GAAI,MAAO,KAAK,IAAhB,CAEA,aAAa,GAAb,CAAkB,IAAlB,CAAwB,WAAxB,CAAqC,UAAU,CAC3C,oBAAoB,mBAApB,CAAwC,QAAS,QAAT,EAAmB,CAE1D,CAFD,CAEG,QAAS,MAAT,CAAe,GAAf,CAAoB,CAEtB,CAJD,EAKH,CAND,EAOH,CAVD,CAUG,QAAS,MAAT,CAAe,GAAf,CAAoB,CACnB,GAAI,YAAa,YAAY,KAAZ,CAAkB,SAAS,MAA3B,CAAjB,CAEA,aAAa,GAAb,CAAkB,WAAW,IAA7B,CAAmC,WAAnC,CAAgD,UAAU,CACtD,OAAO,KAAP,GACH,CAFD,EAGH,CAhBD,EAkBH,CAxBD,IAwBO,IAAI,SAAS,MAAT,GAAoB,gBAAxB,CAA0C,CAC7C;AACA,SAAS,cAAT,CAAwB,QAAxB,EAAkC,SAAlC,CAA8C,cAC1C,gBADJ,CAEH,CAJM,IAIA,CACH;AACA;AACA,SAAS,cAAT,CAAwB,QAAxB,EAAkC,SAAlC,CAA8C,cAC1C,gBADJ,CAEH,CACJ,CAED,QAAS,aAAT,CAAsB,GAAtB,CAA2B,IAA3B,CAAiC,WAAjC,CAA8C,QAA9C,CAAwD,CACpD,QAAQ,CAAC,OAAO,MAAR,CAAgB,IAAI,eAApB,CAAqC,KAAK,CAAE,IAAK,GAAP,CAAY,KAAM,IAAlB,CAAwB,YAAa,WAArC,CAA1C,CAAR,CAAuG,QAAvG,EACH,CAED,QAAS,gBAAT,EAA2B,CACvB,GAAG,cAAH,CAAkB,SAAS,QAAT,CAAmB,CACjC,qBAAqB,QAArB,EACH,CAFD,EAGH,CAED,OAAO,WAAP,CAAqB,UAAW,CAC5B,GAAG,IAAH,CAAQ,CACJ,MAAO,iBADH,CAEJ,OAAQ,IAFJ,CAGJ,MAAO,IAHH,CAIJ,QAAS,MAJL,CAAR,EAOA,GAAG,cAAH,CAAkB,SAAS,QAAT,CAAmB,CACjC,qBAAqB,QAArB,EACH,CAFD,EAIH,CAZD,CAcA,OAAO,YAAP,CAAsB,UAAW,CAEhC,CAFD,CAIC,UAAS,CAAT,CAAY,CAAZ,CAAe,EAAf,CAAmB,CAChB,GAAI,GAAJ,CAAQ,IAAM,EAAE,oBAAF,CAAuB,CAAvB,EAA0B,CAA1B,CAAd,CACA,GAAI,EAAE,cAAF,CAAiB,EAAjB,CAAJ,CAA0B,OAC1B,GAAK,EAAE,aAAF,CAAgB,CAAhB,CAAL,CAAyB,GAAG,EAAH,CAAQ,EAAR,CACzB,GAAG,GAAH,CAAS,gFAAT,CACA,IAAI,UAAJ,CAAe,YAAf,CAA4B,EAA5B,CAAgC,GAAhC,EACH,CANA,EAMC,QAND,CAMW,QANX,CAMqB,gBANrB,CAAD,CAQC,UAAS,CAAT,CAAY,CAAZ,CAAe,EAAf,CAAkB,CACf,GAAI,GAAJ,CAAQ,IAAM,EAAE,oBAAF,CAAuB,CAAvB,EAA0B,CAA1B,CAAd,CACA,GAAI,EAAE,cAAF,CAAiB,EAAjB,CAAJ,CAA0B,CAAC,OAAQ,CACnC,GAAK,EAAE,aAAF,CAAgB,CAAhB,CAAL,CAAyB,GAAG,EAAH,CAAQ,EAAR,CACzB,GAAG,GAAH,CAAS,sDAAT,CACA,IAAI,UAAJ,CAAe,YAAf,CAA4B,EAA5B,CAAgC,GAAhC,EACH,CANA,EAMC,QAND,CAMW,QANX,CAMqB,WANrB,CAAD,CAQA,OAAO,eAAP,CAAyB,eAAzB","file":"login-compiled.js","sourcesContent":["const request = require('browser-request')\nconst queryString = require('query-string');\n\nfunction statusChangeCallback(response) {\n    console.log('statusChangeCallback');\n    console.log(response);\n    // The response object is returned with a status field that lets the\n    // app know the current login status of the person.\n    // Full docs on the response object can be found in the documentation\n    // for FB.getLoginStatus().\n    if (response.status === 'connected') {\n        // Logged into your app and Facebook.\n\n        var uid = response.authResponse.userID;\n        var accessToken = response.authResponse.accessToken;\n\n        MessengerExtensions.getUserID(function success(uids) {\n            var psid = uids.psid;\n\n            sendUserData(uid, psid, accessToken, function(){\n                MessengerExtensions.requestCloseBrowser(function success() {\n\n                }, function error(err) {\n\n                })\n            });\n        }, function error(err) {\n            var parameters = queryString.parse(location.search);\n\n            sendUserData(uid, parameters.psid, accessToken, function(){\n                window.close();\n            });\n        });\n\n    } else if (response.status === 'not_authorized') {\n        // The person is logged into Facebook, but not your app.\n        document.getElementById('status').innerHTML = 'Please log ' +\n            'into this app.';\n    } else {\n        // The person is not logged into Facebook, so we're not sure if\n        // they are logged into this app or not.\n        document.getElementById('status').innerHTML = 'Please log ' +\n            'into Facebook.';\n    }\n}\n\nfunction sendUserData(uid, psid, accessToken, callback) {\n    request({method:'POST', url:'/registerUser', json:{ uid: uid, psid: psid, accessToken: accessToken }}, callback);\n}\n\nfunction checkLoginState() {\n    FB.getLoginStatus(function(response) {\n        statusChangeCallback(response);\n    });\n}\n\nwindow.fbAsyncInit = function() {\n    FB.init({\n        appId: '351144745234713',\n        cookie: true,\n        xfbml: true,\n        version: 'v2.7'\n    });\n\n    FB.getLoginStatus(function(response) {\n        statusChangeCallback(response);\n    });\n\n};\n\nwindow.extAsyncInit = function() {\n\n};\n\n(function(d, s, id) {\n    var js, fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) return;\n    js = d.createElement(s); js.id = id;\n    js.src = \"//connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v2.8&appId=351144745234713\";\n    fjs.parentNode.insertBefore(js, fjs);\n}(document, 'script', 'facebook-jssdk'));\n\n(function(d, s, id){\n    var js, fjs = d.getElementsByTagName(s)[0];\n    if (d.getElementById(id)) {return;}\n    js = d.createElement(s); js.id = id;\n    js.src = \"//connect.facebook.com/en_US/messenger.Extensions.js\";\n    fjs.parentNode.insertBefore(js, fjs);\n}(document, 'script', 'Messenger'));\n\nglobal.checkLoginState = checkLoginState"]}